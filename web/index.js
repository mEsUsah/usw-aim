(()=>{"use strict";Math.PI;function e(e,t){e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight,t.scale=Math.min(e.canvas.width/t.gameWidth,e.canvas.height/t.gameHeight),e.scale(t.scale,t.scale),t.offsetX=Math.floor((e.canvas.width/t.scale-t.gameWidth)/2),t.offsetY=Math.floor((e.canvas.height/t.scale-t.gameHeight)/2),e.translate(t.offsetX,t.offsetY),t.screenStartX=-t.offsetX,t.screenStartY=-t.offsetY,t.screenEndX=2*t.offsetX+t.gameWidth,t.screenEndY=2*t.offsetY+t.gameHeight}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var a=function(e,a){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,a||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==t(a)?a:a+""}var n,o,r,c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.shapes=[],this.state={}},(t=[{key:"addShape",value:function(e){this.shapes.push(e)}},{key:"removeShape",value:function(e){var t=this.shapes.findIndex(function(t){return t.config.name&&t.config.name===e});-1!==t&&this.shapes.splice(t,1)}},{key:"update",value:function(e){this.shapes.forEach(function(t){t.update(e)}),this.shapes=this.shapes.filter(function(e){return!e.config.ttl||e.lifetime<e.config.ttl})}},{key:"draw",value:function(e){this.shapes.length&&(e.save(),e.translate(this.config.x,this.config.y),this.shapes.forEach(function(t){t.draw(e)}),e.restore())}},{key:"checkCollision",value:function(e,t){return!!this.config.outline&&e>=this.config.x-this.config.outline.left&&e<=this.config.x+this.config.outline.right&&t>=this.config.y-this.config.outline.top&&t<=this.config.y+this.config.outline.bottom}}])&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,g(i.key),i)}}function f(e,t,a){return(t=g(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}n=c,r={BOARD:1,BUTTON:2,TEXT:3,ILLUSTRATION:4},(o=i(o="VARIANT"))in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r;var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={},this.config.duration=t.duration||1e3,this.config.loop=t.loop||0,this.config.direction=t.direction||e.FORWARD,this.config.startDelay=t.startDelay||0,this.progress=0,this.lifetime=0,this.loopCount=1}return function(e,t,a){return t&&l(e.prototype,t),a&&l(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"updateProgress",value:function(t){this.progress+=t,this.lifetime+=t,this.lifetime<this.config.startDelay&&(this.progress=0),this.progress>this.config.duration&&(this.config.loop===e.INFINITE||this.loopCount<this.config.loop)&&(this.loopCount++,this.progress=this.progress%this.config.duration),this.progress>this.config.duration&&0===this.config.loop&&(this.progress=this.config.duration)}},{key:"getProgress",value:function(){return this.progress/this.config.duration}}])}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,p(i.key),i)}}function p(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=u(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}f(h,"INFINITE",-1),f(h,"FORWARD",1),f(h,"BACKWARD",2);var m=function(){return function(e,t,a){return t&&d(e.prototype,t),a&&d(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(t,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.config=a,this.animation=null,this.lifetime=0},[{key:"addAnimation",value:function(e){this.animation=e}},{key:"update",value:function(e){this.lifetime+=e,this.animation&&this.animation.updateProgress(e)}},{key:"draw",value:function(e){e.strokeStyle=this.config.color||"red",e.lineWidth=this.config.lineWidth||2,e.save(),e.translate(this.config.x,this.config.y);var t=1,a=h.FORWARD;switch(this.animation&&(t=this.animation.getProgress(),a=this.animation.config.direction),this.type){case"rectangle":e.beginPath(),a===h.FORWARD?e.rect(0,0,this.config.width*t,this.config.height*t):e.rect(this.config.width*(1-t),this.config.height*(1-t),this.config.width*t,this.config.height*t),e.stroke(),this.config.fillColor&&(e.fillStyle=this.config.fillColor,e.fill());break;case"circle":this.config.lineWidth&&(e.lineWidth=this.config.lineWidth),e.beginPath(),a===h.FORWARD?e.arc(0,0,this.config.radius,0,2*Math.PI*t,!1):(1===t&&(t=0),e.arc(0,0,this.config.radius,2*Math.PI*t,0,!1)),e.stroke();break;case"line":this.config.lineWidth&&(e.lineWidth=this.config.lineWidth),e.beginPath(),e.moveTo(0,0),e.lineTo((this.config.x2-this.config.x)*t,(this.config.y2-this.config.y)*t),e.stroke();break;case"polygon":if(!this.config.points||this.config.points.length<2)break;e.beginPath(),e.moveTo(this.config.points[0].x,this.config.points[0].y),this.config.points.forEach(function(t,a){e.lineTo(t.x,t.y)}),e.closePath(),e.stroke(),this.config.fillColor&&(e.fillStyle=this.config.fillColor,e.fill());break;case"text":e.font=this.config.font||"20px Arial",e.fillStyle=this.config.color||"black",e.textAlign=this.config.align||"left",e.textBaseline=this.config.baseline||"alphabetic",e.fillText(this.config.text||"",0,0);break;default:console.warn("GameShape::draw - Unknown shape type: ".concat(this.type))}e.restore()}}])}();function y(e){return new m("text",{x:0,y:0,text:e,font:"30px Consolas",color:"white",align:"left",baseline:"middle"})}function b(){return new m("rectangle",{x:-30,y:-30,width:60,height:60,color:"gray"})}function v(e){return new m("text",{x:0,y:0,text:e,font:"30px Consolas",color:"white",align:"center",baseline:"middle"})}function w(){return new m("line",{x:-20,y:17,x2:20,y2:17,color:"red",lineWidth:5,name:"selected_indicator"})}function S(e,t){var a="Games Played: ".concat(t.gamesPlayed," | Wins: ").concat(t.gamesWon," | Losses: ").concat(t.gamesLost," | Draws: ").concat(t.gamesDrawn);e.addShape(new m("text",{x:0,y:0,text:a,font:"16px Consolas",color:"white",align:"center",baseline:"middle",name:"stats_text"}))}function x(e){var t,a=new c({variant:c.VARIANT.TEXT,x:e.displayData.gameWidth/2,y:80,name:"title_text"});(t=a).addShape(new m("text",{x:0,y:0,text:"Noughts and Crosses",font:"60px Consolas",color:"white",align:"center",baseline:"middle"})),t.addShape(new m("line",{x:-350,y:35,x2:350,y2:35,color:"white",lineWidth:3})),t.addShape(new m("text",{x:0,y:60,text:"Stanley Skarshaug - USW student 23092388",font:"20px Consolas",color:"gray",align:"center",baseline:"middle"})),e.gameObjects.menu.push(a);var i=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth/2,y:e.displayData.gameHeight/5*4,name:"start_button",outline:{top:60,left:60,bottom:60,right:60}});!function(e){e.addShape(new m("rectangle",{x:-60,y:-60,width:120,height:120,color:"red"})),e.addShape(new m("polygon",{x:-0,y:-0,points:[{x:-30,y:-40},{x:40,y:0},{x:-30,y:40}],color:"red",fillColor:"red"}))}(i),e.gameObjects.menu.push(i);var n=new c({variant:c.VARIANT.TEXT,x:50,y:230,name:"size_text"});n.addShape(y("Board Size:")),e.gameObjects.menu.push(n);for(var o=3;o<=8;o++){var r=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480+80*(o-3),y:230,name:"size_button",outline:{top:30,left:30,bottom:30,right:30},boardSize:o});r.addShape(b()),r.addShape(v("".concat(o,"x").concat(o))),o===e.state.boardSize&&r.addShape(w()),e.gameObjects.menu.push(r)}var s=new c({variant:c.VARIANT.TEXT,x:50,y:310,name:"win_length_text"});s.addShape(y("Win Length:")),e.gameObjects.menu.push(s);for(var l=3;l<=8;l++){var f=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480+80*(l-3),y:310,name:"win_length_button",outline:{top:30,left:30,bottom:30,right:30},winLength:l});f.addShape(b()),f.addShape(v("".concat(l))),l===e.state.winLength&&f.addShape(w()),e.gameObjects.menu.push(f)}var g=new c({variant:c.VARIANT.TEXT,x:50,y:390,name:"game_type_text"});g.addShape(y("Game Type:")),e.gameObjects.menu.push(g);var h=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480,y:390,name:"game_type_button",outline:{top:30,left:30,bottom:30,right:30},gameType:H.NORMAL});h.addShape(b()),h.addShape(v("Nor")),h.addShape(w()),e.gameObjects.menu.push(h);var u=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480+80,y:390,name:"game_type_button",outline:{top:30,left:30,bottom:30,right:30},gameType:H.BLOCKED});u.addShape(b()),u.addShape(v("Blk")),e.gameObjects.menu.push(u);var d=new c({variant:c.VARIANT.TEXT,x:50,y:470,name:"player_2_type_text"});d.addShape(y("Player 2:")),e.gameObjects.menu.push(d);var p=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480,y:470,name:"player_2_type_button",outline:{top:30,left:30,bottom:30,right:30},opponentType:F.HUMAN});p.addShape(b()),p.addShape(v("Hum")),p.addShape(w()),e.gameObjects.menu.push(p);var x=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-480+80,y:470,name:"player_2_type_button",outline:{top:30,left:30,bottom:30,right:30},opponentType:F.CPU});x.addShape(b()),x.addShape(v("CPU")),e.gameObjects.menu.push(x);var T=new c({variant:c.VARIANT.TEXT,x:e.displayData.gameWidth/2,y:e.displayData.gameHeight-40,name:"stats_text"});S(T,e.state.stats),e.gameObjects.menu.push(T)}function T(e,t){var a=new m("circle",{x:0,y:0,radius:e.config.cellWidth/2-e.config.cellPadding,color:"rgba(248, 66, 66, 1)",lineWidth:4});a.addAnimation(new h({duration:300})),t.addShape(a)}function A(e){var t,a=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-30,y:30,name:"pause_button",outline:{top:20,left:20,bottom:20,right:20}});(t=a).addShape(new m("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),t.addShape(new m("rectangle",{x:-10,y:-10,width:6,height:20,color:"red",fillColor:"red"})),t.addShape(new m("rectangle",{x:10,y:-10,width:-6,height:20,color:"red",fillColor:"red"})),e.gameObjects.gameplay.push(a);var i=new c({variant:c.VARIANT.TEXT,x:30,y:37.5,name:"turn_indicator"});!function(e){e.addShape(new m("text",{x:0,y:0,text:"Player:",font:"30px Consolas",color:"white"}))}(i),e.gameObjects.gameplay.push(i)}function O(e){e.gameObjects.gameplay=e.gameObjects.gameplay.filter(function(e){return"turn_symbol"!==e.config.name});var t,a=new c({variant:c.VARIANT.ILLUSTRATION,x:165,y:30,name:"turn_symbol"});1==e.state.currentPlayer?((t=a).addShape(new m("line",{x:-15,y:-15,x2:15,y2:15,color:"rgba(40, 151, 255, 1)",lineWidth:4})),t.addShape(new m("line",{x:15,y:-15,x2:-15,y2:15,color:"rgba(40, 151, 255, 1)",lineWidth:4}))):function(e){e.addShape(new m("circle",{x:0,y:0,radius:15,color:"rgba(248, 66, 66, 1)",lineWidth:4}))}(a),e.gameObjects.gameplay.push(a)}function N(e){var t,a=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-30,y:30,name:"continue_button",outline:{top:20,left:20,bottom:20,right:20}});(t=a).addShape(new m("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),t.addShape(new m("polygon",{points:[{x:-10,y:-10},{x:10,y:0},{x:-10,y:10}],color:"red",fillColor:"red"})),e.gameObjects.paused.push(a);var i=new c({variant:c.VARIANT.BUTTON,x:e.displayData.gameWidth-80,y:30,name:"stop_button",outline:{top:20,left:20,bottom:20,right:20}});!function(e){e.addShape(new m("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),e.addShape(new m("rectangle",{x:-10,y:-10,width:20,height:20,color:"red",fillColor:"red"}))}(i),e.gameObjects.paused.push(i);var n=new c({variant:c.VARIANT.TEXT,x:e.displayData.gameWidth/2,y:e.displayData.gameHeight/2,name:"pause_text"});!function(e){e.addShape(new m("text",{x:-150,y:0,text:"Game Paused",font:"50px Consolas",color:"white"}));var t=new m("line",{x:-150,y:5,x2:150,y2:5,color:"white",lineWidth:4});t.addAnimation(new h({duration:1e3,loop:h.INFINITE})),e.addShape(t)}(n),e.gameObjects.paused.push(n)}function P(e,t){var a=W(e,t,1,0);if(a)return a;var i=W(e,t,1,1);if(i)return i;var n=W(e,t,0,1);if(n)return n;var o=W(e,t,-1,1);return o||!1}function W(e,t,a,i){for(var n=t.config.location,o={x:null,y:null,x2:null,y2:null},r=t.config.location.x,c=t.config.location.y;r>=0&&c>=0&&r<e.config.boardSize&&c<e.config.boardSize&&e.gameFields[r][c].state&&e.gameFields[r][c].state.occupiedBy==t.state.occupiedBy;)n=e.gameFields[r][c].config.location,o.x=e.gameFields[r][c].config.x,o.y=e.gameFields[r][c].config.y,r-=a,c-=i;var s=0;for(r=n.x,c=n.y;r<e.config.boardSize&&c<e.config.boardSize&&r>=0&&c>=0&&e.gameFields[r][c].state&&e.gameFields[r][c].state.occupiedBy==t.state.occupiedBy;){if(++s>=e.state.winLength)return o.x2=e.gameFields[r][c].config.x,o.y2=e.gameFields[r][c].config.y,o;r+=a,c+=i}return!1}function _(e){var t=Math.pow(e.state.boardSize,2);return e.state.occupiedSpaces>=t}function I(e,t){var a=new c({variant:c.VARIANT.ILLUSTRATION,x:0,y:0,name:"win_line"}),i=new m("line",{x:t.x,y:t.y,x2:t.x2,y2:t.y2,color:"red",lineWidth:15});i.addAnimation(new h({duration:300})),a.addShape(i),e.gameObjects.gameplay.push(a)}function j(e,t){var a=new c({variant:c.VARIANT.ILLUSTRATION,x:e.displayData.gameWidth/2,y:32,name:"gameover_text"});a.addShape(new m("text",{x:0,y:0,text:t,font:"48px Consolas",color:"red",align:"center",baseline:"middle"})),e.gameObjects.gameplay.push(a)}function E(){if(!localStorage.getItem("gameStats")){localStorage.setItem("gameStats",JSON.stringify({gamesPlayed:0,gamesWon:0,gamesLost:0,gamesDrawn:0}))}return JSON.parse(localStorage.getItem("gameStats"))}function R(e,t){switch(e.state.stats.gamesPlayed++,t){case 1:e.state.stats.gamesWon++;break;case 2:e.state.stats.gamesLost++;break;default:e.state.stats.gamesDrawn++}var a;a=e.state.stats,localStorage.setItem("gameStats",JSON.stringify(a)),function(e){var t=e.gameObjects.menu.find(function(e){return"stats_text"===e.config.name});t&&(t.shapes=[],S(t,e.state.stats))}(e)}function k(e,t){e.gameObjects[V.GAMEPLAY].forEach(function(a){if(0==e.state.gameOver&&a.config.variant==c.VARIANT.BOARD&&a.checkCollision(t.x,t.y)&&null==a.state.occupiedBy){switch(a.state.occupiedBy=e.state.currentPlayer,e.state.occupiedSpaces++,e.state.currentPlayer){case 1:!function(e,t){var a=new m("line",{x:e.config.cellPadding-e.config.cellWidth/2,y:e.config.cellPadding-e.config.cellHeight/2,x2:e.config.cellWidth/2-e.config.cellPadding,y2:e.config.cellHeight/2-e.config.cellPadding,color:"rgba(40, 151, 255, 1)",lineWidth:4});a.addAnimation(new h({duration:150,direction:h.BACKWARD})),t.addShape(a);var i=new m("line",{x:e.config.cellPadding-e.config.cellWidth/2,y:e.config.cellHeight/2-e.config.cellPadding,x2:e.config.cellWidth/2-e.config.cellPadding,y2:-e.config.cellHeight/2+e.config.cellPadding,color:"rgba(40, 151, 255, 1)",lineWidth:4});i.addAnimation(new h({duration:150,startDelay:150})),t.addShape(i)}(e,a);break;case 2:T(e,a)}var i=P(e,a);if(i)return I(e,i),e.state.gameOver=!0,j(e,"Game Over"),void R(e,e.state.currentPlayer);if(_(e))return e.state.gameOver=!0,j(e,"Game Over"),void R(e,0);switch(e.state.currentPlayer){case 1:e.state.currentPlayer=2;break;case 2:e.state.currentPlayer=1}O(e)}a.config.variant==c.VARIANT.BUTTON&&a.checkCollision(t.x,t.y)&&"pause_button"===a.config.name&&(e.view=V.PAUSED)})}function D(e,t){e.gameObjects[V.MENU].forEach(function(a){if(a.config.variant==c.VARIANT.BUTTON&&a.checkCollision(t.x,t.y)){if("start_button"===a.config.name&&(e.view=V.GAMEPLAY,e.resetState(),function(e){e.gameObjects.gameplay=e.gameObjects.gameplay.filter(function(e){return"win_line"!=e.config.name}),e.gameObjects.gameplay=e.gameObjects.gameplay.filter(function(e){return"gameover_text"!=e.config.name}),e.gameObjects.gameplay=e.gameObjects.gameplay.filter(function(e){return e.config.variant!==c.VARIANT.BOARD}),e.gameFields=[];for(var t=0;t<e.config.boardSize;t++){for(var a=[],i=0;i<e.config.boardSize;i++){var n=new c({variant:c.VARIANT.BOARD,x:e.config.cellWidth/2+t*e.config.cellWidth+e.config.boardMargin,y:e.config.cellHeight/2+i*e.config.cellHeight+e.config.boardMargin,name:"board_tile",outline:{top:e.config.cellHeight/2,left:e.config.cellWidth/2,bottom:e.config.cellHeight/2,right:e.config.cellWidth/2},location:{x:t,y:i}}),o=new m("rectangle",{x:-e.config.cellWidth/2,y:-e.config.cellHeight/2,width:e.config.cellWidth,height:e.config.cellHeight,color:"gray"});n.addShape(o),e.gameObjects.gameplay.push(n),a.push(n)}e.gameFields.push(a)}if(e.state.gameType===H.BLOCKED)for(var r=e.state.boardSize-2,s=0;s<r;s++){for(;;){var l=Math.floor(Math.random()*e.state.boardSize),f=Math.floor(Math.random()*e.state.boardSize),g=e.gameFields[l][f];if(null==g.state.occupiedBy){g.state.occupiedBy=0,g.addShape(new m("rectangle",{x:-e.config.cellWidth/2+4,y:-e.config.cellHeight/2+4,width:e.config.cellWidth-8,height:e.config.cellHeight-8,color:"black",fillColor:"gray"})),g.addShape(new m("text",{x:0,y:0,text:"blocked",font:"".concat(e.config.cellWidth/8,"px Consolas"),color:"black",align:"center",baseline:"middle"}));break}}e.state.occupiedSpaces++}}(e)),"size_button"===a.config.name){if(a.config.boardSize===e.state.boardSize)return;e.state.boardSize=a.config.boardSize,e.state.boardSize<e.state.winLength&&(e.state.winLength=e.state.boardSize,C(e,"winLength","win_length_button")),C(e,"boardSize","size_button"),e.updateConfig()}if("win_length_button"===a.config.name){if(a.config.winLength===e.state.winLength)return;if(a.config.winLength>e.state.boardSize)return;e.state.winLength=a.config.winLength,C(e,"winLength","win_length_button"),e.updateConfig()}"game_type_button"===a.config.name&&(e.state.gameType=a.config.gameType,C(e,"gameType","game_type_button")),"player_2_type_button"===a.config.name&&(e.state.opponentType=a.config.opponentType,C(e,"opponentType","player_2_type_button"))}})}function C(e,t,a){e.gameObjects[V.MENU].forEach(function(i){i.config.variant==c.VARIANT.BUTTON&&i.config.name===a&&(i.removeShape("selected_indicator"),i.config[t]===e.state[t]&&i.addShape(w()))})}function L(e){e.userInputs.forEach(function(t){if("click"==t.type)switch(e.view){case V.GAMEPLAY:k(e,t);break;case V.PAUSED:!function(e,t){e.gameObjects[V.PAUSED].forEach(function(a){a.config.variant==c.VARIANT.BUTTON&&a.checkCollision(t.x,t.y)&&("continue_button"===a.config.name&&(e.view=V.GAMEPLAY),"stop_button"===a.config.name&&(e.view=V.MENU))})}(e,t);break;case V.MENU:D(e,t)}}),e.userInputs=[]}function B(e){e.state.cpuWaitTime-=e.frameData.deltaTime,e.state.cpuWaitTime>0||(e.state.cpuWaitTime=e.state.cpuMoveDelay,function(e){for(;;){var t=Math.floor(Math.random()*e.state.boardSize),a=Math.floor(Math.random()*e.state.boardSize),i=e.gameFields[t][a];if(null==i.state.occupiedBy){i.state.occupiedBy=e.state.currentPlayer,e.state.occupiedSpaces++,T(e,i),e.state.currentPlayer=1;var n=P(e,i);if(n){I(e,n),e.state.gameOver=!0,j(e,"Game Over"),R(e,2);break}if(_(e)){e.state.gameOver=!0,j(e,"Game Over"),R(e,0);break}O(e);break}}}(e))}function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function U(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,z(i.key),i)}}function z(e){var t=function(e,t){if("object"!=M(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=M(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==M(t)?t:t+""}var V={GAMEPLAY:"gameplay",MENU:"menu",PAUSED:"paused"},H={NORMAL:0,BLOCKED:1},F={HUMAN:0,CPU:1},X=function(){return function(e,t,a){return t&&U(e.prototype,t),a&&U(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}(function t(a){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=a,this.ctx=a.getContext("2d"),this.frameData={lastTime:0,deltaTime:0,fps:{accum:0,frames:0,avg:0}},this.displayData={gameWidth:800,gameHeight:800,scale:1,offsetX:0,offsetY:0,screenStartX:0,screenStartY:0,screenEndX:0,screenEndY:0},this.view=V.MENU,this.gameObjects={gameplay:[],menu:[],paused:[]},this.gameFields=[],this.userInputs=[],function(e){var t=window.devicePixelRatio,a=function(){return+getComputedStyle(e).getPropertyValue("height").slice(0,-2)},i=function(){return+getComputedStyle(e).getPropertyValue("width").slice(0,-2)};e.setAttribute("width",i()*t),e.setAttribute("height",a()*t)}(this.canvas),window.addEventListener("resize",function(){e(i.ctx,i.displayData)}),a.addEventListener("click",function(e){var t=function(e,t,a){var i=a.getBoundingClientRect();return{x:(e.clientX-i.left)/t.scale-t.offsetX,y:(e.clientY-i.top)/t.scale-t.offsetY}}(e,i.displayData,i.canvas);i.userInputs.push({type:"click",x:t.x,y:t.y})}),this.state={gameType:H.NORMAL,opponentType:F.HUMAN,boardSize:3,winLength:3,currentPlayer:1,occupiedSpaces:0,gameOver:!1,cpuMoveDelay:500,cpuWaitTime:500,stats:E()},this.config={},this.updateConfig(),x(this),A(this),N(this),O(this),this.start()},[{key:"updateConfig",value:function(){var e=this.state.boardSize;this.config={boardSize:e,boardMargin:60,cellWidth:680/e,cellHeight:680/e,cellPadding:20}}},{key:"resetState",value:function(){this.state.occupiedSpaces=0,this.state.gameOver=!1}},{key:"start",value:function(){var t=this;e(this.ctx,this.displayData),window.requestAnimationFrame(function(e){return t.gameLoop(e)})}},{key:"gameLoop",value:function(e){var t,a,i=this;!function(e,t){t.deltaTime=e-t.lastTime,t.lastTime=e,t.fps.accum+=Math.floor(1e3/t.deltaTime),t.fps.frames++,t.fps.frames>=60&&(t.fps.avg=Math.floor(t.fps.accum/t.fps.frames),t.fps.accum=0,t.fps.frames=0)}(e,this.frameData),this.state.gameOver||2!=this.state.currentPlayer||this.state.opponentType!==F.CPU?L(this):B(this),this.gameObjects[this.view].forEach(function(e){e.update(i.frameData.deltaTime)}),t=this.ctx,a=this.displayData,t.clearRect(a.screenStartX,a.screenStartY,a.gameWidth+2*a.offsetX,a.gameHeight+2*a.offsetY),this.gameObjects[this.view].forEach(function(e){e.draw(i.ctx)}),window.requestAnimationFrame(function(e){return i.gameLoop(e)})}}])}();window.onload=function(){var e=document.getElementById("gameCanvas");new X(e)}})();