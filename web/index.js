(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(e){var a=function(e,a){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,a||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==t(a)?a:a+""}var i,n,o,r=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.shapes=[],this.state={}},(a=[{key:"addShape",value:function(t){this.shapes.push(t)}},{key:"removeShape",value:function(t){var e=this.shapes.findIndex(function(e){return e.config.name&&e.config.name===t});-1!==e&&this.shapes.splice(e,1)}},{key:"update",value:function(t){this.shapes.forEach(function(e){e.update(t)}),this.shapes=this.shapes.filter(function(t){return!t.config.ttl||t.lifetime<t.config.ttl})}},{key:"draw",value:function(t){this.shapes.length&&(t.save(),t.translate(this.config.x,this.config.y),this.shapes.forEach(function(e){e.draw(t)}),t.restore())}},{key:"checkCollision",value:function(t,e){return!!this.config.outline&&t>=this.config.x-this.config.outline.left&&t<=this.config.x+this.config.outline.right&&e>=this.config.y-this.config.outline.top&&e<=this.config.y+this.config.outline.bottom}}])&&e(t.prototype,a),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,a,i}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function l(t,e,a){return(e=f(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function f(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}i=r,o={BOARD:1,BUTTON:2,TEXT:3,ILLUSTRATION:4},(n=a(n="VARIANT"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o;var g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={},this.config.duration=e.duration||1e3,this.config.loop=e.loop||0,this.config.direction=e.direction||t.FORWARD,this.config.startDelay=e.startDelay||0,this.progress=0,this.lifetime=0,this.loopCount=1}return function(t,e,a){return e&&c(t.prototype,e),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"updateProgress",value:function(e){this.progress+=e,this.lifetime+=e,this.lifetime<this.config.startDelay&&(this.progress=0),this.progress>this.config.duration&&(this.config.loop===t.INFINITE||this.loopCount<this.config.loop)&&(this.loopCount++,this.progress=this.progress%this.config.duration),this.progress>this.config.duration&&0===this.config.loop&&(this.progress=this.config.duration)}},{key:"getProgress",value:function(){return this.progress/this.config.duration}}])}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function u(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function d(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=h(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:e+""}l(g,"INFINITE",-1),l(g,"FORWARD",1),l(g,"BACKWARD",2);var p=function(){return function(t,e,a){return e&&u(t.prototype,e),a&&u(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.config=a,this.animation=null,this.lifetime=0},[{key:"addAnimation",value:function(t){this.animation=t}},{key:"update",value:function(t){this.lifetime+=t,this.animation&&this.animation.updateProgress(t)}},{key:"draw",value:function(t){t.strokeStyle=this.config.color||"red",t.lineWidth=this.config.lineWidth||2,t.save(),t.translate(this.config.x,this.config.y);var e=1,a=g.FORWARD;switch(this.animation&&(e=this.animation.getProgress(),a=this.animation.config.direction),this.type){case"rectangle":t.beginPath(),a===g.FORWARD?t.rect(0,0,this.config.width*e,this.config.height*e):t.rect(this.config.width*(1-e),this.config.height*(1-e),this.config.width*e,this.config.height*e),t.stroke(),this.config.fillColor&&(t.fillStyle=this.config.fillColor,t.fill());break;case"circle":this.config.lineWidth&&(t.lineWidth=this.config.lineWidth),t.beginPath(),a===g.FORWARD?t.arc(0,0,this.config.radius,0,2*Math.PI*e,!1):(1===e&&(e=0),t.arc(0,0,this.config.radius,2*Math.PI*e,0,!1)),t.stroke();break;case"line":this.config.lineWidth&&(t.lineWidth=this.config.lineWidth),t.beginPath(),t.moveTo(0,0),t.lineTo((this.config.x2-this.config.x)*e,(this.config.y2-this.config.y)*e),t.stroke();break;case"polygon":if(!this.config.points||this.config.points.length<2)break;t.beginPath(),t.moveTo(this.config.points[0].x,this.config.points[0].y),this.config.points.forEach(function(e,a){t.lineTo(e.x,e.y)}),t.closePath(),t.stroke(),this.config.fillColor&&(t.fillStyle=this.config.fillColor,t.fill());break;case"text":t.font=this.config.font||"20px Arial",t.fillStyle=this.config.color||"black",t.textAlign=this.config.align||"left",t.textBaseline=this.config.baseline||"alphabetic",t.fillText(this.config.text||"",0,0);break;default:console.warn("GameShape.draw() - Unknown shape type: ".concat(this.type))}t.restore()}}])}();function m(t,e){var a=new p("circle",{x:0,y:0,radius:t.config.cellWidth/2-t.config.cellPadding,color:"rgba(248, 66, 66, 1)",lineWidth:4});a.addAnimation(new g({duration:300})),e.addShape(a)}function y(t){var e,a=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-30,y:30,name:"pause_button",outline:{top:20,left:20,bottom:20,right:20}});(e=a).addShape(new p("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),e.addShape(new p("rectangle",{x:-10,y:-10,width:6,height:20,color:"red",fillColor:"red"})),e.addShape(new p("rectangle",{x:10,y:-10,width:-6,height:20,color:"red",fillColor:"red"})),t.state.gameObjects.gameplay.push(a);var i=new r({variant:r.VARIANT.TEXT,x:30,y:37.5,name:"turn_indicator"});!function(t){t.addShape(new p("text",{x:0,y:0,text:"Player:",font:"30px Consolas",color:"white"}))}(i),t.state.gameObjects.gameplay.push(i)}function b(t){t.state.gameObjects.gameplay=t.state.gameObjects.gameplay.filter(function(t){return"turn_symbol"!==t.config.name});var e,a=new r({variant:r.VARIANT.ILLUSTRATION,x:165,y:30,name:"turn_symbol"});1==t.state.currentPlayer?((e=a).addShape(new p("line",{x:-15,y:-15,x2:15,y2:15,color:"rgba(40, 151, 255, 1)",lineWidth:4})),e.addShape(new p("line",{x:15,y:-15,x2:-15,y2:15,color:"rgba(40, 151, 255, 1)",lineWidth:4}))):function(t){t.addShape(new p("circle",{x:0,y:0,radius:15,color:"rgba(248, 66, 66, 1)",lineWidth:4}))}(a),t.state.gameObjects.gameplay.push(a)}function v(t,e){var a=S(t,e,1,0);if(a)return a;var i=S(t,e,1,1);if(i)return i;var n=S(t,e,0,1);if(n)return n;var o=S(t,e,-1,1);return o||!1}function S(t,e,a,i){for(var n=e.config.location,o={x:null,y:null,x2:null,y2:null},r=e.config.location.x,s=e.config.location.y;r>=0&&s>=0&&r<t.config.boardSize&&s<t.config.boardSize&&t.state.gameFields[r][s].state&&t.state.gameFields[r][s].state.occupiedBy==e.state.occupiedBy;)n=t.state.gameFields[r][s].config.location,o.x=t.state.gameFields[r][s].config.x,o.y=t.state.gameFields[r][s].config.y,r-=a,s-=i;var c=0;for(r=n.x,s=n.y;r<t.config.boardSize&&s<t.config.boardSize&&r>=0&&s>=0&&t.state.gameFields[r][s].state&&t.state.gameFields[r][s].state.occupiedBy==e.state.occupiedBy;){if(++c>=t.state.winLength)return o.x2=t.state.gameFields[r][s].config.x,o.y2=t.state.gameFields[r][s].config.y,o;r+=a,s+=i}return!1}function w(t){var e=Math.pow(t.state.boardSize,2);return t.state.occupiedSpaces>=e}function x(t,e){var a=new r({variant:r.VARIANT.ILLUSTRATION,x:0,y:0,name:"win_line"}),i=new p("line",{x:e.x,y:e.y,x2:e.x2,y2:e.y2,color:"red",lineWidth:15});i.addAnimation(new g({duration:300})),a.addShape(i),t.state.gameObjects.gameplay.push(a)}function T(t,e){var a=new r({variant:r.VARIANT.ILLUSTRATION,x:t.displayState.gameWidth/2,y:32,name:"gameover_text"});a.addShape(new p("text",{x:0,y:0,text:e,font:"48px Consolas",color:"red",align:"center",baseline:"middle"})),t.state.gameObjects.gameplay.push(a)}function O(t){return new p("text",{x:0,y:0,text:t,font:"30px Consolas",color:"white",align:"left",baseline:"middle"})}function A(){return new p("rectangle",{x:-30,y:-30,width:60,height:60,color:"gray"})}function P(t){return new p("text",{x:0,y:0,text:t,font:"30px Consolas",color:"white",align:"center",baseline:"middle"})}function N(){return new p("line",{x:-20,y:17,x2:20,y2:17,color:"red",lineWidth:5,name:"selected_indicator"})}function W(){return new p("rectangle",{x:-25,y:-25,width:50,height:50,color:"#00000088",fillColor:"#000000aa",name:"disabled_overlay"})}function E(t,e){var a="Games Played: ".concat(e.gamesPlayed," | Wins: ").concat(e.gamesWon," | Losses: ").concat(e.gamesLost," | Draws: ").concat(e.gamesDrawn);t.addShape(new p("text",{x:0,y:0,text:a,font:"16px Consolas",color:"white",align:"center",baseline:"middle",name:"stats_text"}))}function I(t){var e,a=new r({variant:r.VARIANT.TEXT,x:t.displayState.gameWidth/2,y:80,name:"title_text"});(e=a).addShape(new p("text",{x:0,y:0,text:"Noughts and Crosses",font:"60px Consolas",color:"white",align:"center",baseline:"middle"})),e.addShape(new p("line",{x:-350,y:35,x2:350,y2:35,color:"white",lineWidth:3})),e.addShape(new p("text",{x:0,y:60,text:"Stanley Skarshaug - USW student 23092388",font:"20px Consolas",color:"gray",align:"center",baseline:"middle"})),t.state.gameObjects.menu.push(a);var i=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth/2,y:t.displayState.gameHeight/5*4,name:"start_button",outline:{top:60,left:60,bottom:60,right:60}});!function(t){t.addShape(new p("rectangle",{x:-60,y:-60,width:120,height:120,color:"red"})),t.addShape(new p("polygon",{x:-0,y:-0,points:[{x:-30,y:-40},{x:40,y:0},{x:-30,y:40}],color:"red",fillColor:"red"}))}(i),t.state.gameObjects.menu.push(i);var n=new r({variant:r.VARIANT.TEXT,x:50,y:230,name:"size_text"});n.addShape(O("Board Size:")),t.state.gameObjects.menu.push(n);for(var o=3;o<=8;o++){var s=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480+80*(o-3),y:230,name:"size_button",outline:{top:30,left:30,bottom:30,right:30},boardSize:o});s.addShape(A()),s.addShape(P("".concat(o,"x").concat(o))),o===t.state.boardSize&&s.addShape(N()),t.state.gameObjects.menu.push(s)}var c=new r({variant:r.VARIANT.TEXT,x:50,y:310,name:"win_length_text"});c.addShape(O("Win Length:")),t.state.gameObjects.menu.push(c);for(var l=3;l<=8;l++){var f=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480+80*(l-3),y:310,name:"win_length_button",outline:{top:30,left:30,bottom:30,right:30},winLength:l});f.addShape(A()),f.addShape(P("".concat(l))),l===t.state.winLength&&f.addShape(N()),l>t.state.winLength&&f.addShape(W()),t.state.gameObjects.menu.push(f)}var g=new r({variant:r.VARIANT.TEXT,x:50,y:390,name:"game_type_text"});g.addShape(O("Game Type:")),t.state.gameObjects.menu.push(g);var h=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480,y:390,name:"game_type_button",outline:{top:30,left:30,bottom:30,right:30},gameType:H.TYPE.NORMAL});h.addShape(A()),h.addShape(P("Nor")),h.addShape(N()),t.state.gameObjects.menu.push(h);var u=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480+80,y:390,name:"game_type_button",outline:{top:30,left:30,bottom:30,right:30},gameType:H.TYPE.BLOCKED});u.addShape(A()),u.addShape(P("Blk")),t.state.gameObjects.menu.push(u);var d=new r({variant:r.VARIANT.TEXT,x:50,y:470,name:"player_2_type_text"});d.addShape(O("Player 2:")),t.state.gameObjects.menu.push(d);var m=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480,y:470,name:"player_2_type_button",outline:{top:30,left:30,bottom:30,right:30},opponentType:H.OPPONENT.HUMAN});m.addShape(A()),m.addShape(P("Hum")),m.addShape(N()),t.state.gameObjects.menu.push(m);var y=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-480+80,y:470,name:"player_2_type_button",outline:{top:30,left:30,bottom:30,right:30},opponentType:H.OPPONENT.CPU});y.addShape(A()),y.addShape(P("CPU")),t.state.gameObjects.menu.push(y);var b=new r({variant:r.VARIANT.TEXT,x:t.displayState.gameWidth/2,y:t.displayState.gameHeight-40,name:"stats_text"});E(b,t.state.stats),t.state.gameObjects.menu.push(b)}function _(){if(!localStorage.getItem("gameStats")){localStorage.setItem("gameStats",JSON.stringify({gamesPlayed:0,gamesWon:0,gamesLost:0,gamesDrawn:0}))}return JSON.parse(localStorage.getItem("gameStats"))}function j(t,e){switch(t.state.stats.gamesPlayed++,e){case 1:t.state.stats.gamesWon++;break;case 2:t.state.stats.gamesLost++;break;default:t.state.stats.gamesDrawn++}var a;a=t.state.stats,localStorage.setItem("gameStats",JSON.stringify(a)),function(t){var e=t.state.gameObjects.menu.find(function(t){return"stats_text"===t.config.name});e&&(e.shapes=[],E(e,t.state.stats))}(t)}function R(t,e){t.state.gameObjects[H.VIEW.GAMEPLAY].forEach(function(a){if(0==t.state.gameOver&&a.config.variant==r.VARIANT.BOARD&&a.checkCollision(e.x,e.y)&&null==a.state.occupiedBy){switch(a.state.occupiedBy=t.state.currentPlayer,t.state.occupiedSpaces++,t.state.currentPlayer){case 1:!function(t,e){var a=new p("line",{x:t.config.cellPadding-t.config.cellWidth/2,y:t.config.cellPadding-t.config.cellHeight/2,x2:t.config.cellWidth/2-t.config.cellPadding,y2:t.config.cellHeight/2-t.config.cellPadding,color:"rgba(40, 151, 255, 1)",lineWidth:4});a.addAnimation(new g({duration:150,direction:g.BACKWARD})),e.addShape(a);var i=new p("line",{x:t.config.cellPadding-t.config.cellWidth/2,y:t.config.cellHeight/2-t.config.cellPadding,x2:t.config.cellWidth/2-t.config.cellPadding,y2:-t.config.cellHeight/2+t.config.cellPadding,color:"rgba(40, 151, 255, 1)",lineWidth:4});i.addAnimation(new g({duration:150,startDelay:150})),e.addShape(i)}(t,a);break;case 2:m(t,a)}var i=v(t,a);if(i)return x(t,i),t.state.gameOver=!0,T(t,"Game Over"),void j(t,t.state.currentPlayer);if(w(t))return t.state.gameOver=!0,T(t,"Game Over"),void j(t,0);switch(t.state.currentPlayer){case 1:t.state.currentPlayer=2;break;case 2:t.state.currentPlayer=1}b(t)}a.config.variant==r.VARIANT.BUTTON&&a.checkCollision(e.x,e.y)&&"pause_button"===a.config.name&&(t.state.view=H.VIEW.PAUSED)})}function k(t,e){t.state.gameObjects[H.VIEW.MENU].forEach(function(a){if(a.config.variant==r.VARIANT.BUTTON&&a.checkCollision(e.x,e.y)){if("start_button"===a.config.name&&(t.state.view=H.VIEW.GAMEPLAY,t.resetState(),function(t){t.state.gameObjects.gameplay=t.state.gameObjects.gameplay.filter(function(t){return"win_line"!=t.config.name}),t.state.gameObjects.gameplay=t.state.gameObjects.gameplay.filter(function(t){return"gameover_text"!=t.config.name}),t.state.gameObjects.gameplay=t.state.gameObjects.gameplay.filter(function(t){return t.config.variant!==r.VARIANT.BOARD}),t.state.gameFields=[];for(var e=0;e<t.config.boardSize;e++){for(var a=[],i=0;i<t.config.boardSize;i++){var n=new r({variant:r.VARIANT.BOARD,x:t.config.cellWidth/2+e*t.config.cellWidth+t.config.boardMargin,y:t.config.cellHeight/2+i*t.config.cellHeight+t.config.boardMargin,name:"board_tile",outline:{top:t.config.cellHeight/2,left:t.config.cellWidth/2,bottom:t.config.cellHeight/2,right:t.config.cellWidth/2},location:{x:e,y:i}}),o=new p("rectangle",{x:-t.config.cellWidth/2,y:-t.config.cellHeight/2,width:t.config.cellWidth,height:t.config.cellHeight,color:"gray"});n.addShape(o),t.state.gameObjects.gameplay.push(n),a.push(n)}t.state.gameFields.push(a)}if(t.state.gameType===H.TYPE.BLOCKED)for(var s=t.state.boardSize-2,c=0;c<s;c++){for(;;){var l=Math.floor(Math.random()*t.state.boardSize),f=Math.floor(Math.random()*t.state.boardSize),g=t.state.gameFields[l][f];if(null==g.state.occupiedBy){g.state.occupiedBy=0,g.addShape(new p("rectangle",{x:-t.config.cellWidth/2+4,y:-t.config.cellHeight/2+4,width:t.config.cellWidth-8,height:t.config.cellHeight-8,color:"black",fillColor:"gray"})),g.addShape(new p("text",{x:0,y:0,text:"blocked",font:"".concat(t.config.cellWidth/8,"px Consolas"),color:"black",align:"center",baseline:"middle"}));break}}t.state.occupiedSpaces++}}(t)),"size_button"===a.config.name){if(a.config.boardSize===t.state.boardSize)return;t.state.boardSize=a.config.boardSize,t.state.boardSize<t.state.winLength&&(t.state.winLength=t.state.boardSize,C(t,"winLength","win_length_button")),C(t,"boardSize","size_button"),function(t){t.state.gameObjects[H.VIEW.MENU].forEach(function(e){e.config.variant==r.VARIANT.BUTTON&&"win_length_button"===e.config.name&&(e.removeShape("disabled_overlay"),e.config.winLength>t.state.boardSize&&e.addShape(W()))})}(t),t.updateConfig()}if("win_length_button"===a.config.name){if(a.config.winLength===t.state.winLength)return;if(a.config.winLength>t.state.boardSize)return;t.state.winLength=a.config.winLength,C(t,"winLength","win_length_button"),t.updateConfig()}"game_type_button"===a.config.name&&(t.state.gameType=a.config.gameType,C(t,"gameType","game_type_button")),"player_2_type_button"===a.config.name&&(t.state.opponentType=a.config.opponentType,C(t,"opponentType","player_2_type_button"))}})}function C(t,e,a){t.state.gameObjects[H.VIEW.MENU].forEach(function(i){i.config.variant==r.VARIANT.BUTTON&&i.config.name===a&&(i.removeShape("selected_indicator"),i.config[e]===t.state[e]&&i.addShape(N()))})}function V(t){t.state.userInputs.forEach(function(e){if("click"==e.type)switch(t.state.view){case H.VIEW.GAMEPLAY:R(t,e);break;case H.VIEW.PAUSED:!function(t,e){t.state.gameObjects[H.VIEW.PAUSED].forEach(function(a){a.config.variant==r.VARIANT.BUTTON&&a.checkCollision(e.x,e.y)&&("continue_button"===a.config.name&&(t.state.view=H.VIEW.GAMEPLAY),"stop_button"===a.config.name&&(t.state.view=H.VIEW.MENU))})}(t,e);break;case H.VIEW.MENU:k(t,e)}}),t.state.userInputs=[]}function L(t){t.state.cpuWaitTime-=t.displayState.deltaTime,t.state.cpuWaitTime>0||(t.state.cpuWaitTime=t.state.cpuMoveDelay,function(t){for(;;){var e=Math.floor(Math.random()*t.state.boardSize),a=Math.floor(Math.random()*t.state.boardSize),i=t.state.gameFields[e][a];if(null==i.state.occupiedBy){i.state.occupiedBy=t.state.currentPlayer,t.state.occupiedSpaces++,m(t,i),t.state.currentPlayer=1;var n=v(t,i);if(n){x(t,n),t.state.gameOver=!0,T(t,"Game Over"),j(t,2);break}if(w(t)){t.state.gameOver=!0,T(t,"Game Over"),j(t,0);break}b(t);break}}}(t))}function B(t){var e,a=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-30,y:30,name:"continue_button",outline:{top:20,left:20,bottom:20,right:20}});(e=a).addShape(new p("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),e.addShape(new p("polygon",{points:[{x:-10,y:-10},{x:10,y:0},{x:-10,y:10}],color:"red",fillColor:"red"})),t.state.gameObjects.paused.push(a);var i=new r({variant:r.VARIANT.BUTTON,x:t.displayState.gameWidth-80,y:30,name:"stop_button",outline:{top:20,left:20,bottom:20,right:20}});!function(t){t.addShape(new p("rectangle",{x:-20,y:-20,width:40,height:40,color:"red"})),t.addShape(new p("rectangle",{x:-10,y:-10,width:20,height:20,color:"red",fillColor:"red"}))}(i),t.state.gameObjects.paused.push(i);var n=new r({variant:r.VARIANT.TEXT,x:t.displayState.gameWidth/2,y:t.displayState.gameHeight/2,name:"pause_text"});!function(t){t.addShape(new p("text",{x:-150,y:0,text:"Game Paused",font:"50px Consolas",color:"white"}));var e=new p("line",{x:-150,y:5,x2:150,y2:5,color:"white",lineWidth:4});e.addAnimation(new g({duration:1e3,loop:g.INFINITE})),t.addShape(e)}(n),t.state.gameObjects.paused.push(n)}Math.PI;function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function U(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,D(i.key),i)}}function z(t,e,a){return(e=D(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function D(t){var e=function(t,e){if("object"!=M(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=M(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==M(e)?e:e+""}var H=function(){function t(e){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.ctx=e.getContext("2d"),this.displayState={gameWidth:800,gameHeight:800,scale:1,offsetX:0,offsetY:0,screenStartX:0,screenStartY:0,screenEndX:0,screenEndY:0,lastTime:0,deltaTime:0,fps:{accum:0,frames:0,avg:0}},a=this,window.addEventListener("resize",function(){utils.resizeCanvas(a.ctx,a.displayState)}),a.canvas.addEventListener("click",function(t){var e=function(t,e,a){var i=a.getBoundingClientRect();return{x:(t.clientX-i.left)/e.scale-e.offsetX,y:(t.clientY-i.top)/e.scale-e.offsetY}}(t,a.displayState,a.canvas);a.state.userInputs.push({type:"click",x:e.x,y:e.y})}),function(t){var e=window.devicePixelRatio,a=function(){return+getComputedStyle(t).getPropertyValue("height").slice(0,-2)},i=function(){return+getComputedStyle(t).getPropertyValue("width").slice(0,-2)};t.setAttribute("width",i()*e),t.setAttribute("height",a()*e)}(this.canvas),this.state={view:t.VIEW.MENU,userInputs:[],gameType:t.TYPE.NORMAL,opponentType:t.OPPONENT.HUMAN,boardSize:3,winLength:3,currentPlayer:1,occupiedSpaces:0,gameOver:!1,gameFields:[],gameObjects:{gameplay:[],menu:[],paused:[]},cpuMoveDelay:500,cpuWaitTime:500,stats:_()},this.config={},this.updateConfig(),I(this),y(this),b(this),B(this),this.start()}return function(t,e,a){return e&&U(t.prototype,e),a&&U(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"updateConfig",value:function(){var t=this.state.boardSize;this.config={boardSize:t,boardMargin:60,cellWidth:680/t,cellHeight:680/t,cellPadding:20}}},{key:"resetState",value:function(){this.state.occupiedSpaces=0,this.state.gameOver=!1}},{key:"start",value:function(){var t,e,a=this;t=this.ctx,e=this.displayState,t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight,e.scale=Math.min(t.canvas.width/e.gameWidth,t.canvas.height/e.gameHeight),t.scale(e.scale,e.scale),e.offsetX=Math.floor((t.canvas.width/e.scale-e.gameWidth)/2),e.offsetY=Math.floor((t.canvas.height/e.scale-e.gameHeight)/2),t.translate(e.offsetX,e.offsetY),e.screenStartX=-e.offsetX,e.screenStartY=-e.offsetY,e.screenEndX=2*e.offsetX+e.gameWidth,e.screenEndY=2*e.offsetY+e.gameHeight,window.requestAnimationFrame(function(t){return a.gameLoop(t)})}},{key:"gameLoop",value:function(e){var a,i,n=this;!function(t,e){e.deltaTime=t-e.lastTime,e.lastTime=t,e.fps.accum+=Math.floor(1e3/e.deltaTime),e.fps.frames++,e.fps.frames>=60&&(e.fps.avg=Math.floor(e.fps.accum/e.fps.frames),e.fps.accum=0,e.fps.frames=0)}(e,this.displayState),this.state.gameOver||2!=this.state.currentPlayer||this.state.opponentType!==t.OPPONENT.CPU?V(this):L(this),this.state.gameObjects[this.state.view].forEach(function(t){t.update(n.displayState.deltaTime)}),a=this.ctx,i=this.displayState,a.clearRect(i.screenStartX,i.screenStartY,i.gameWidth+2*i.offsetX,i.gameHeight+2*i.offsetY),this.state.gameObjects[this.state.view].forEach(function(t){t.draw(n.ctx)}),window.requestAnimationFrame(function(t){return n.gameLoop(t)})}}])}();z(H,"TYPE",{NORMAL:0,BLOCKED:1}),z(H,"OPPONENT",{HUMAN:0,CPU:1}),z(H,"VIEW",{GAMEPLAY:"gameplay",MENU:"menu",PAUSED:"paused"}),window.onload=function(){var t=document.getElementById("gameCanvas");new H(t)}})();