(()=>{"use strict";Math.PI;function t(t,e){t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight,e.scale=Math.min(t.canvas.width/e.gameWidth,t.canvas.height/e.gameHeight),t.scale(e.scale,e.scale),e.offsetX=Math.floor((t.canvas.width/e.scale-e.gameWidth)/2),e.offsetY=Math.floor((t.canvas.height/e.scale-e.gameHeight)/2),t.translate(e.offsetX,e.offsetY),e.screenStartX=-e.offsetX,e.screenStartY=-e.offsetY,e.screenEndX=2*e.offsetX+e.gameWidth,e.screenEndY=2*e.offsetY+e.gameHeight}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function o(t){var i=function(t,i){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,i||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(t)}(t,"string");return"symbol"==e(i)?i:i+""}var n=function(){return t=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.animations=[],this.shapes=[]},(e=[{key:"addShape",value:function(t){this.shapes.push(t)}},{key:"update",value:function(t){this.shapes.forEach(function(e){e.update(t)}),this.shapes=this.shapes.filter(function(t){return!t.config.ttl||t.lifetime<t.config.ttl})}},{key:"draw",value:function(t){this.shapes.length&&(t.save(),this.shapes.forEach(function(e){e.draw(t)}),t.restore())}}])&&i(t.prototype,e),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,o}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,f(o.key),o)}}function s(t,e,i){return(e=f(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={},this.config.duration=e.duration||1e3,this.config.loop=e.loop||0,this.config.direction=e.direction||t.FORWARD,this.config.startDelay=e.startDelay||0,this.progress=0,this.lifetime=0,this.loopCount=1}return e=t,(i=[{key:"updateProgress",value:function(e){this.progress+=e,this.lifetime+=e,this.lifetime<this.config.startDelay&&(this.progress=0),this.progress>this.config.duration&&(this.config.loop===t.INFINITE||this.loopCount<this.config.loop)&&(this.loopCount++,this.progress=this.progress%this.config.duration),this.progress>this.config.duration&&0===this.config.loop&&(this.progress=this.config.duration)}},{key:"getProgress",value:function(){return this.progress/this.config.duration}}])&&a(e.prototype,i),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,o}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,u(o.key),o)}}function u(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}s(l,"INFINITE",-1),s(l,"FORWARD",1),s(l,"BACKWARD",2);var m=function(){return t=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.config=i,this.animation=null,this.lifetime=0},(e=[{key:"addAnimation",value:function(t){this.animation=t}},{key:"update",value:function(t){this.lifetime+=t,this.animation&&this.animation.updateProgress(t)}},{key:"draw",value:function(t){t.strokeStyle=this.config.color||"red",t.lineWidth=this.config.lineWidth||2,t.save(),t.translate(this.config.x,this.config.y);var e=1,i=l.FORWARD;this.animation&&(e=this.animation.getProgress(),i=this.animation.config.direction),"circle"===this.type&&(t.beginPath(),i===l.FORWARD?t.arc(0,0,this.config.radius,0,2*Math.PI*e,!1):(1===e&&(e=0),t.arc(0,0,this.config.radius,2*Math.PI*e,0,!1)),t.stroke()),"line"==this.type&&(t.beginPath(),t.moveTo(0,0),t.lineTo((this.config.x2-this.config.x)*e,(this.config.y2-this.config.y)*e),t.stroke()),t.restore()}}])&&h(t.prototype,e),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function d(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,y(o.key),o)}}function y(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,e||"default");if("object"!=g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}var p=function(){return e=function e(i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=i,this.ctx=i.getContext("2d"),this.frameData={lastTime:0,deltaTime:0,fps:{accum:0,frames:0,avg:0}},this.displayData={gameWidth:800,gameHeight:600,scale:1,offsetX:0,offsetY:0,screenStartX:0,screenStartY:0,screenEndX:0,screenEndY:0},function(t){var e=window.devicePixelRatio,i=function(){return+getComputedStyle(t).getPropertyValue("height").slice(0,-2)},o=function(){return+getComputedStyle(t).getPropertyValue("width").slice(0,-2)};t.setAttribute("width",o()*e),t.setAttribute("height",i()*e)}(this.canvas),window.addEventListener("resize",function(){t(o.ctx,o.displayData)}),this.gameObjects=[],i.addEventListener("click",function(t){var e=i.getBoundingClientRect(),r=(t.clientX-e.left)/o.displayData.scale-o.displayData.offsetX,a=(t.clientY-e.top)/o.displayData.scale-o.displayData.offsetY,s=new n(r,a),f=new m("line",{x:r+100,y:a-100,x2:r,y2:a}),c=new l({duration:100,startDelay:0,direction:l.FORWARD,loop:!1});f.addAnimation(c),s.addShape(f);var h=new m("line",{x:r,y:a-10,x2:r,y2:a}),u=new l({duration:1,startDelay:100,direction:l.FORWARD,loop:!1});h.addAnimation(u),s.addShape(h);var g=new m("line",{x:r+10,y:a,x2:r,y2:a}),d=new l({duration:1,startDelay:100,direction:l.FORWARD,loop:!1});g.addAnimation(d),s.addShape(g),o.gameObjects.push(s)}),this.start()},(i=[{key:"start",value:function(){var e=this;t(this.ctx,this.displayData),window.requestAnimationFrame(function(t){return e.gameLoop(t)})}},{key:"gameLoop",value:function(t){var e,i,o=this;!function(t,e){e.deltaTime=t-e.lastTime,e.lastTime=t,e.fps.accum+=Math.floor(1e3/e.deltaTime),e.fps.frames++,e.fps.frames>=60&&(e.fps.avg=Math.floor(e.fps.accum/e.fps.frames),e.fps.accum=0,e.fps.frames=0)}(t,this.frameData),this.gameObjects.forEach(function(t){t.update(o.frameData.deltaTime)}),e=this.ctx,i=this.displayData,e.clearRect(i.screenStartX,i.screenStartY,i.gameWidth+2*i.offsetX,i.gameHeight+2*i.offsetY),function(t,e,i,o,n,r){e=e||{scale:1,offsetX:0,offsetY:0,width:800,height:800},i=i||10,o=o||5*i,n=n||"#00FF00",r=r||"#009900",t.save(),t.strokeStyle=n,t.fillStyle=r,t.font="16px Arial";for(var a=-(e.offsetX-e.offsetX%i),s=Math.max(e.offsetX+e.gameWidth,e.gameWidth),f=-(e.offsetY-e.offsetY%i),l=Math.max(e.offsetY+e.gameHeight,e.gameHeight),c=a;c<s;c+=i)t.beginPath(),t.moveTo(c,f),t.lineTo(c,l),c%o==0?(t.lineWidth=.5,t.fillText(c,c,13)):t.lineWidth=.25,t.stroke();for(var h=f;h<l;h+=i)t.beginPath(),t.moveTo(a,h),t.lineTo(s,h),h%o==0?(t.lineWidth=.5,t.fillText(h,0,h+13)):t.lineWidth=.25,t.stroke();t.beginPath(),t.strokeStyle="red",t.fillStyle="red",t.lineWidth=2,t.moveTo(0,e.gameHeight/2),t.lineTo(10-e.offsetX,e.gameHeight/2),t.lineTo(10-e.offsetX,e.gameHeight/2-5),t.lineTo(-e.offsetX,e.gameHeight/2),t.lineTo(10-e.offsetX,e.gameHeight/2+5),t.lineTo(10-e.offsetX,e.gameHeight/2),t.stroke(),t.fill(),t.beginPath(),t.moveTo(e.gameWidth,e.gameHeight/2),t.lineTo(e.gameWidth-10+e.offsetX,e.gameHeight/2),t.lineTo(e.gameWidth-10+e.offsetX,e.gameHeight/2-5),t.lineTo(e.gameWidth+e.offsetX,e.gameHeight/2),t.lineTo(e.gameWidth-10+e.offsetX,e.gameHeight/2+5),t.lineTo(e.gameWidth-10+e.offsetX,e.gameHeight/2),t.stroke(),t.fill(),t.beginPath(),t.moveTo(e.gameWidth/2,0),t.lineTo(e.gameWidth/2,10-e.offsetY),t.lineTo(e.gameWidth/2-5,10-e.offsetY),t.lineTo(e.gameWidth/2,-e.offsetY),t.lineTo(e.gameWidth/2+5,10-e.offsetY),t.lineTo(e.gameWidth/2,10-e.offsetY),t.stroke(),t.fill(),t.beginPath(),t.moveTo(e.gameWidth/2,e.gameHeight),t.lineTo(e.gameWidth/2,e.gameHeight+e.offsetY-10),t.lineTo(e.gameWidth/2-5,e.gameHeight+e.offsetY-10),t.lineTo(e.gameWidth/2,e.gameHeight+e.offsetY),t.lineTo(e.gameWidth/2+5,e.gameHeight+e.offsetY-10),t.lineTo(e.gameWidth/2,e.gameHeight+e.offsetY-10),t.stroke(),t.fill(),t.strokeStyle="red",t.lineWidth=4,t.fillStyle="red",t.strokeRect(20,20,e.gameWidth-40,e.gameHeight-40),t.restore()}(this.ctx,this.displayData),function(t,e){t.save(),t.fillStyle="white",t.font="24px Arial",t.fillText("FPS: "+e,30,48),t.restore()}(this.ctx,this.frameData.fps.avg),this.gameObjects.forEach(function(t){t.draw(o.ctx)}),window.requestAnimationFrame(function(t){return o.gameLoop(t)})}}])&&d(e.prototype,i),o&&d(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,o}();window.onload=function(){var t=document.getElementById("gameCanvas");new p(t)}})();